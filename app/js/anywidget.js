import { $APP, shadow$provide, $jscomp } from "./common.js";
var tI=function(){var a=$APP.Om(1);$APP.sm(function(){var b=function(){function d(e){var f=e[1];if(f===7){var g=e[7];f=$APP.u(oI);f=!$APP.Vd(f,g);e[8]=f;e[1]=f?10:11;return $APP.Km}if(f===1)return f=$APP.u(pI),f=$APP.Ih(f),g=$APP.D(f),e[9]=g,e[2]=null,e[1]=2,$APP.Km;if(f===4){g=e[9];var k=$APP.E(g),n=$APP.iw.g(k);f=$APP.If(k,new $APP.V(null,2,5,$APP.W,[$APP.pw,$APP.Cy],null));g=[$APP.r.g(n),"$",$APP.r.g(f)].join("");var p=$APP.u(qI),q=["models:",$APP.r.g(n)].join(""),t=$APP.si.g(f);p=$APP.If(p,new $APP.V(null,
4,5,$APP.W,[q,$APP.Nv,t,$APP.dz],null));k=$APP.Bi($APP.N([k]));n=$APP.Bi($APP.N(["cell",n,"model",f,"schem",g,"typ",p]));e[10]=f;e[7]=g;e[11]=p;e[12]=k;e[13]=n;e[1]=$APP.m(f)?7:8;return $APP.Km}return f===15?(e[2]=e[2],e[1]=6,$APP.Km):f===13?(g=e[7],f=$APP.Z.s(rI,$APP.Y,g,$APP.Lg),g=$APP.cn(sI,g,$APP.Ql(rI,new $APP.V(null,1,5,$APP.W,[g],null))),n=$APP.Z.s(oI,$APP.Y,g.group,g.cache),k=g.fc,e[15]=f,e[14]=g,e[16]=n,$APP.Lm(e,16,k)):f===6?(e[2]=e[2],e[1]=3,$APP.Km):f===3?$APP.Mm(e,e[2]):f===12?(e[2]=
e[2],e[1]=9,$APP.Km):f===2?(g=e[9],f=$APP.D(g),e[1]=f?4:5,$APP.Km):f===11?(f=e[8],e[2]=f,e[1]=12,$APP.Km):f===9?(e[1]=$APP.m(e[2])?13:14,$APP.Km):f===5?(e[2]=null,e[1]=6,$APP.Km):f===14?(g=e[9],g=$APP.G(g),e[9]=g,e[2]=null,e[1]=2,$APP.Km):f===16?(g=e[9],n=e[14],f=e[2],g=$APP.G(g),n=$APP.u(n),n=$APP.Ih(n),n=$APP.D(n),g=$APP.Cf.h(g,n),e[17]=f,e[9]=g,e[2]=null,e[1]=2,$APP.Km):f===10?(f=e[11],f=$APP.K.h(f,"schematic"),e[2]=f,e[1]=12,$APP.Km):f===8?(f=e[10],e[2]=f,e[1]=9,$APP.Km):null}return function(){function e(k){for(;;){a:{try{for(;;){var n=
d(k);if(!$APP.R(n,$APP.Km)){var p=n;break a}}}catch(q){p=q;k[2]=p;if($APP.D(k[4]))k[1]=$APP.E(k[4]);else throw p;p=$APP.Km;break a}p=void 0}if(!$APP.R(p,$APP.Km))return p}}function f(){var k=[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null];k[0]=g;k[1]=1;return k}var g=null;g=function(k){switch(arguments.length){case 0:return f.call(this);case 1:return e.call(this,k)}throw Error("Invalid arity: "+arguments.length);};g.o=f;g.g=e;return g}()}(),c=function(){var d=
b();d[6]=a;return d}();return $APP.Jm(c)})},uI=new $APP.Q("nyancad.mosaic.anywidget","anywidget-sync","nyancad.mosaic.anywidget/anywidget-sync",-1693447253);var vI=new URLSearchParams(window.location.search),wI,xI=vI.get("schem");wI=$APP.m(xI)?xI:"myschem";var yI=vI.get("db"),sI=new $APP.sz($APP.m(yI)?yI:"schematics"),rI=$APP.Pl($APP.Ze([wI,$APP.S,"models",$APP.S])),pI=$APP.cn(sI,wI,$APP.Ql(rI,new $APP.V(null,1,5,$APP.W,[wI],null))),qI=$APP.cn(sI,"models",$APP.Ql(rI,new $APP.V(null,1,5,$APP.W,["models"],null))),zI=$APP.cn(sI,[$APP.r.g(wI),"$result"].join(""),$APP.Pl($APP.Eh())),oI=$APP.an(sI,$APP.N([pI,qI,zI]));export const render=function(a){var b=a.model;a.el.innerHTML="Connected to editor.";b.set("schematic_data",$APP.wl($APP.u(rI)));b.save_changes();$APP.Gi(rI,uI,function(c,d,e,f){$APP.Bi($APP.N(["Schematic updated, syncing to anywidget model"]));tI();b.set("schematic_data",$APP.wl(f));return b.save_changes()});b.on("change:simulation_data",function(){var c=$APP.Qi(b.get("simulation_data")),d=(new Date).toISOString();d=[$APP.r.g(wI),"$result:",$APP.r.g(d)].join("");$APP.Bi($APP.N(["Received simulation data from Python, storing with key:",
d]));return $APP.Z.s(zI,$APP.Y,d,c)});return null};